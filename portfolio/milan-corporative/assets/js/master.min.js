jQuery(document).ready(function($){$(document).on("dragstart",function(e){e.preventDefault()});var c_mapElement=document.getElementById("map_container");if(c_mapElement){var c_mapOptions={zoom:15,center:new google.maps.LatLng(58.015536,56.233134),mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!1,streetViewControl:!1,scrollwheel:!1,mapTypeControlOptions:{mapTypeIds:[]}};new google.maps.Map(c_mapElement,c_mapOptions)}var sholder=$(".scrollable-holder");if(sholder.length){var container=sholder.parent().parent(),head=$(".head-container"),head_fixed=!1,foot=$(".foot-container"),foot_fixed=!1,diff=container.offset().top-(head.offset().top+head.outerHeight()),height=sholder[0].scrollHeight-sholder[0].clientHeight-diff;$(window).resize(function(e){diff=container.offset().top-(head.offset().top+head.outerHeight()),height=sholder[0].scrollHeight-sholder[0].clientHeight-diff}),sholder.scroll(function(e){var scrollTop=sholder.scrollTop();!head_fixed&&diff<scrollTop?(head.addClass("head-container-fixed"),head_fixed=!0):head_fixed&&scrollTop<=diff&&(head.removeClass("head-container-fixed"),head_fixed=!1),console.log(scrollTop,height,foot_fixed),!foot_fixed&&scrollTop<height?(foot.addClass("foot-container-fixed"),foot_fixed=!0):foot_fixed&&height<=scrollTop&&(foot.removeClass("foot-container-fixed"),foot_fixed=!1)}),sholder.scroll(),head.mousemove(function(){if(head_fixed){head.addClass("hover"),!1!==interval&&(clearInterval(interval),interval=!1);var interval=setInterval(function(){head.is(":not(:hover)")&&(head.removeClass("hover"),clearInterval(interval),interval=!1)},1e3)}})}var cholder=$(".case-label");if(cholder.length){var first=cholder.first(),parent=(cholder.last(),first.parent()),anchor=$('<p class="inblock"></p>');parent.append(anchor);var drag=$('<p class="inblock"></p>');parent.prepend(drag);var button_prev=$('.case-diff[data-diff="-1"]'),button_next=$('.case-diff[data-diff="1"]'),button_prev_disabled=!1,button_next_disabled=!1,maxleft=anchor.position().left-parseInt(drag.css("margin-left"))-parent.innerWidth();$(window).resize(function(){maxleft=anchor.position().left-parseInt(drag.css("margin-left"))-parent.innerWidth()});function fitBound(left){left<-maxleft?(left=-maxleft,button_next_disabled||(button_next.addClass("disabled"),button_next_disabled=!0)):button_next_disabled&&(button_next.removeClass("disabled"),button_next_disabled=!1),0<=left?(left=0,button_prev_disabled||(button_prev.addClass("disabled"),button_prev_disabled=!0)):button_prev_disabled&&(button_prev.removeClass("disabled"),button_prev_disabled=!1),drag.css({"margin-left":left+"px"})}function refresh(){cholder.each(function(){var el=$(this),clip_l=(el.children().first().offset().left+el.innerWidth()/2)/window.innerWidth*(el.find("img").innerWidth()-el.innerWidth()),left=(el.innerWidth(),el.children().first().position().left),top=el.children().first().position().top;el.children().last().addClass("top left").css({transform:"translate("+left+"px,"+top+"px)"}).find("img").css({transform:"translateX("+-clip_l+"px)"})})}cholder.each(function(){var el=$(this);el.prepend('<p class="absolute"></p>');var clip_l=(el.children().first().offset().left+el.innerWidth()/2)/window.innerWidth*(el.find("img").innerWidth()-el.innerWidth()),left=(el.innerWidth(),el.children().first().position().left),top=el.children().first().position().top;el.children().last().addClass("top left").css({transform:"translate("+left+"px,"+top+"px)"}).find("img").css({transform:"translateX("+-clip_l+"px)"})}),fitBound(0);var interval=setInterval(refresh,100),pos=!1,hoverToggle=!1;parent.mousedown(function(e){pos=e.pageX-parseInt(drag.css("margin-left")),clearInterval(interval)}),$(document).mouseup(function(e){!1!==pos&&(pos=!1,parent.removeClass("case-label-cholder-disabled"),interval=setInterval(refresh,100))}),$(document).mousemove(function(e){!1!==pos?(parent.addClass("case-label-cholder-disabled"),fitBound(e.pageX-pos),refresh()):hoverToggle&&(cholder.removeClass("hover"),parent.removeClass("hover"),hoverToggle=!1)}),cholder.mouseover(function(){cholder.not(this).removeClass("hover"),$(this).addClass("hover"),parent.addClass("hover"),hoverToggle=!1}),cholder.mouseout(function(){hoverToggle=!0});var filter=$(".case-filter");filter.click(function(e){e.preventDefault(),$(this).attr("data-type")?$(this).hasClass("active")?$(this).removeClass("active"):(filter.removeClass("active"),$(this).addClass("active")):filter.removeClass("active"),filter.filter(".active").length?cholder.addClass("hidden").filter(function(){return!!filter.filter('.active[data-type="'+this.dataset.type+'"]').length}).removeClass("hidden"):cholder.removeClass("hidden"),maxleft=anchor.position().left-parseInt(drag.css("margin-left"))-parent.innerWidth(),fitBound(parseInt(drag.css("margin-left"))),refresh()}),$(".case-diff").click(function(e){e.preventDefault();var diff=parseInt(this.dataset.diff),el_s=cholder.filter(function(){return 5<$(this).children().first().position().left*diff}),el=1==diff?el_s.first():el_s.last();fitBound(parseInt(drag.css("margin-left"))-el.children().first().position().left)})}});